# Tarot Website Backend API

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT) <!-- Optional: Add a license badge if applicable -->

Backend API service for the Tarot Website application, providing functionalities for user management, Tarot card information, readings, astrology insights, chat, and payment processing (currently postponed). Built with Node.js, Express, and MongoDB.

## ‚ú® Key Features

*   **User Management:** Registration, Login (JWT), Profile Management, Password Reset, Role-Based Access Control (User, Admin).
*   **Tarot Cards:** Retrieve card details, list all cards, filter by deck/type, Admin CRUD operations.
*   **Readings:** Create new readings, retrieve history, get specific readings, add interpretations (Reader role), add feedback (User role), Admin CRUD operations.
*   **Astrology:** Get zodiac sign info, daily horoscopes, compatibility checks, Tarot-zodiac relations, Admin CRUD for signs and horoscopes.
*   **Chat:** Create chats, send/retrieve messages, mark as read, schedule chats (basic implementation).
*   **Payment (Postponed):** Stripe integration for subscription management (currently disabled).
*   **API Documentation:** Available via Swagger UI.
*   **Testing:** Unit and integration tests using Jest and Supertest.
*   **Docker Support:** Ready for containerized deployment.

*(Refer to `cline_docs/projectRoadmap.md` for more details)*

## üõ†Ô∏è Tech Stack

*   **Backend:** Node.js, Express.js
*   **Database:** MongoDB (with Mongoose ODM)
*   **Authentication:** JSON Web Tokens (JWT)
*   **Validation:** express-validator
*   **Testing:** Jest, Supertest
*   **API Documentation:** Swagger (via swagger-jsdoc, swagger-ui-express)
*   **Containerization:** Docker, Docker Compose
*   **Logging:** Winston (with daily rotation)
*   **Security:** Helmet, CORS, express-rate-limit

*(Refer to `cline_docs/techStack.md` for more details)*

## üöÄ Getting Started

### Prerequisites

*   Node.js (v18 or later recommended)
*   npm or yarn
*   MongoDB instance (local or remote)
*   Git

### Installation & Setup

1.  **Clone the repository:**
    ```bash
    git clone https://github.com/NguyenQS504092s/Tarot-Website-Backend-.git
    cd Tarot-Website-Backend-
    ```

2.  **Install dependencies:**
    ```bash
    npm install
    # or
    yarn install
    ```

3.  **Set up Environment Variables:**
    *   Create a `.env` file in the project root.
    *   Copy the contents of `.env.example` (if available) or add the following required variables:
        ```env
        NODE_ENV=development # or production
        PORT=5000 # Or any port you prefer
        MONGODB_URI=mongodb://localhost:27017/tarot_dev # Your development DB connection string
        MONGODB_TEST_URI=mongodb://localhost:27017/tarot_test # Your test DB connection string
        JWT_SECRET=your_very_strong_jwt_secret # Generate a strong secret key
        JWT_EXPIRES_IN=90d
        JWT_REFRESH_EXPIRES_IN=180d

        # Optional for Email (Password Reset) - Configure your email service
        # EMAIL_HOST=
        # EMAIL_PORT=
        # EMAIL_USERNAME=
        # EMAIL_PASSWORD=
        # EMAIL_FROM=

        # Optional for Stripe (Currently Disabled)
        # STRIPE_SECRET_KEY=sk_test_...
        # STRIPE_WEBHOOK_SECRET=whsec_...
        ```
    *   **Important:** Replace placeholder values with your actual configuration, especially `MONGODB_URI`, `MONGODB_TEST_URI`, and `JWT_SECRET`. Generate a strong `JWT_SECRET`.

4.  **Ensure MongoDB is running.**

### Running the Application

*   **Development Mode (with nodemon for auto-restarts):**
    ```bash
    npm run dev
    ```
*   **Production Mode:**
    ```bash
    npm start
    ```
    The server will start, typically on the `PORT` specified in your `.env` file (default: 5000).

### Running Tests

```bash
npm test
```
*(Ensure your test database (`MONGODB_TEST_URI`) is accessible)*

## üê≥ Running with Docker

1.  **Ensure Docker and Docker Compose are installed.**
2.  **Build and run the services:**
    ```bash
    docker-compose up --build -d
    ```
    This will build the backend image and start the backend service along with a MongoDB service defined in `docker-compose.yml`. The backend will typically be accessible on the port mapped in `docker-compose.yml` (e.g., 5000).
3.  **To stop the services:**
    ```bash
    docker-compose down
    ```

## üìñ API Documentation

Once the server is running, API documentation generated by Swagger is available at:
`http://localhost:<PORT>/api-docs` (Replace `<PORT>` with the actual port number, e.g., 5000)

## ü§ù Contributing

Contributions are welcome! Please follow standard Git workflow (fork, branch, pull request). Ensure tests pass and adhere to existing code style.

## üìú License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details (if applicable).
